it_cols <- paste0("it", 1:length(items))
colnames(items) <- it_cols
str(items)
faltantes_items <- items %>%
summarise(across(everything(), ~ sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "item", values_to = "n_faltantes") %>%
arrange(desc(n_faltantes))
print(faltantes_items)
df_limpio <- df[complete.cases(items), ]
analizar_grupo <- function(df, items, k = 6) {
sub <- df[, 27 + items, drop = FALSE]
colnames(sub) <- paste0("item_", items)
cor_original <- cor(sub, use = "pairwise.complete.obs")
cor_prom_original <- rowMeans(cor_original, na.rm = TRUE)
cor_prom_invertido <- sapply(seq_along(sub), function(i) {
sub_i <- sub
sub_i[[i]] <- (k + 1) - sub_i[[i]]
cor_mat_i <- cor(sub_i, use = "pairwise.complete.obs")
rowMeans(cor_mat_i, na.rm = TRUE)[i]
})
data.frame(
item = paste0("item_", items),
cor_prom_original = round(cor_prom_original, 3),
cor_prom_invertido = round(cor_prom_invertido, 3)
)
}
analizar_grupo(df_limpio, c(7, 17))      # Autoaceptación
analizar_grupo(df_limpio, c(21, 27, 28)) # Crecimiento personal
analizar_grupo(df_limpio, c(6, 11, 15, 16, 20)) # Propósito de vida
analizar_grupo(df_limpio, c(10, 14, 29)) # Dominio del entorno
analizar_grupo(df_limpio, c(2, 12, 25))  # Relaciones positivas
analizar_grupo(df_limpio, c(3, 18))      # Autonomía
# Invertir ítem identificado
df_limpio$`A menudo me siento solo porque tengo pocos amigos íntimos con quienes compartir mis preocupaciones.` <-
7 - df_limpio$`A menudo me siento solo porque tengo pocos amigos íntimos con quienes compartir mis preocupaciones.`
items <- df_limpio[, 28:ncol(df_limpio)]
resumen_items <- items %>%
summarise(across(everything(),
list(
media = ~ mean(.x, na.rm = TRUE),
mediana = ~ median(.x, na.rm = TRUE),
sd = ~ sd(.x, na.rm = TRUE),
min = ~ min(.x, na.rm = TRUE),
max = ~ max(.x, na.rm = TRUE)
),
.names = "{.col}_{.fn}"))
resumen_largo <- resumen_items %>%
pivot_longer(everything(), names_to = c("item", ".value"), names_sep = "_")
head(resumen_largo)
frecuencias_items <- items %>%
pivot_longer(everything(), names_to = "item", values_to = "valor") %>%
group_by(item, valor) %>%
summarise(frecuencia = n(), .groups = "drop_last") %>%
mutate(porcentaje = round(100 * frecuencia / sum(frecuencia), 2)) %>%
arrange(item, valor)
print(head(frecuencias_items, 12))
for (i in unique(frecuencias_items$item)) {
p <- frecuencias_items %>%
filter(item == i) %>%
ggplot(aes(x = factor(valor), y = porcentaje, fill = factor(valor))) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = paste0(porcentaje, "%")), vjust = -0.3, size = 3) +
scale_fill_brewer(palette = "Blues") +
labs(title = paste("Distribución de frecuencias -", i),
x = "Valor de respuesta (1 a 6)", y = "Porcentaje (%)") +
theme_minimal()
print(p)
}
items_num <- items %>% mutate(across(everything(), as.numeric))
df_limpio <- df_limpio %>%
mutate(metrica_global = rowSums(items_num, na.rm = TRUE))
# Resumen General
resumen_general <- df_limpio %>%
summarise(
total_encuestados = n(),
suma_total = sum(metrica_global, na.rm = TRUE),
promedio_general = mean(metrica_global, na.rm = TRUE),
desviacion_estandar = sd(metrica_global, na.rm = TRUE)
)
# Resumen Modalidad
resumen_modalidad <- df_limpio %>%
group_by(Modalidad) %>%
summarise(
promedio_modalidad = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Nivel de formación
resumen_nivel <- df_limpio %>%
group_by(`Nivel de formación`) %>%
summarise(
promedio_nivel = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Género
resumen_genero <- df_limpio %>%
group_by(Género) %>%
summarise(
promedio_genero = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Estrato Socioeconomico
resumen_estrato <- df_limpio %>%
group_by(`Estrato socioeconómico`) %>%
summarise(
promedio_estrato = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
cat("\nResumen general:\n"); print(resumen_general)
cat("\nResumen por modalidad:\n"); print(resumen_modalidad)
cat("\nResumen por nivel de formación:\n"); print(resumen_nivel)
cat("\nResumen por género:\n"); print(resumen_genero)
cat("\nResumen por estrato socioeconómico:\n"); print(resumen_estrato)
describe(items)
pc <- hetcor(items)$correlations ; pc
pc <- hetcor(items)$correlations ; pc
library(polycor)
pc <- hetcor(items)$correlations ; pc
# ============================================================
# 8. MATRIZ POLICORICA Y ANALISIS PARALELO
# ============================================================
str(items)
sapply(items, class)
pc <- hetcor(items)$correlations ; pc
pc <- hetcor(items)$correlations ; pc
fa.parallel(pc, n.obs = nrow(items), fm = "minres")
pc <- hetcor(items)$correlations ; pc
describe(items)
describe(items)
sapply(items, class)
# ============================================================
# 8. MATRIZ POLICORICA Y ANALISIS PARALELO
# ============================================================
items[] <- lapply(items, ordered)
pc <- hetcor(items)$correlations ; pc
str(items)
# --- Paquetes ---
library(readxl)
library(dplyr)
library(tidyr)
library(psych)
library(polycor)
library(openxlsx)
library(janitor)
library(ggplot2)
df <- read_excel("C:/Users/LENOVO/Music/CONSULTORIA/PRIMERCORTE/Proyecto-Medicion-de-la-Felicidad-SANTOTO/Insumos/Formulario de la escala de bienestar subjetivo(1-280).xlsx")
tab <- read_excel(
"C:/Users/LENOVO/Music/CONSULTORIA/PRIMERCORTE/Proyecto-Medicion-de-la-Felicidad-SANTOTO/Insumos/TABULACIÓN DE RESULTADOS PRUEBA PILOTO.xlsx",
range = "A1:K19"
) %>%
mutate(
categoria = case_when(
row_number() %in% 1:2   ~ "AUTOACEPTACIÓN",
row_number() %in% 3:5   ~ "CRECIMIENTO PERSONAL",
row_number() %in% 6:10  ~ "PROPÓSITO DE VIDA",
row_number() %in% 11:13 ~ "DOMINIO DEL ENTORNO",
row_number() %in% 14:16 ~ "RELACIONES POSITIVAS",
row_number() %in% 17:18 ~ "AUTONOMÍA"
)
) %>%
select(categoria, everything(), -2)
items <- df[, 28:ncol(df)]
it_cols <- paste0("it", 1:length(items))
colnames(items) <- it_cols
str(items)
faltantes_items <- items %>%
summarise(across(everything(), ~ sum(is.na(.)))) %>%
pivot_longer(everything(), names_to = "item", values_to = "n_faltantes") %>%
arrange(desc(n_faltantes))
print(faltantes_items)
df_limpio <- df[complete.cases(items), ]
analizar_grupo <- function(df, items, k = 6) {
sub <- df[, 27 + items, drop = FALSE]
colnames(sub) <- paste0("item_", items)
cor_original <- cor(sub, use = "pairwise.complete.obs")
cor_prom_original <- rowMeans(cor_original, na.rm = TRUE)
cor_prom_invertido <- sapply(seq_along(sub), function(i) {
sub_i <- sub
sub_i[[i]] <- (k + 1) - sub_i[[i]]
cor_mat_i <- cor(sub_i, use = "pairwise.complete.obs")
rowMeans(cor_mat_i, na.rm = TRUE)[i]
})
data.frame(
item = paste0("item_", items),
cor_prom_original = round(cor_prom_original, 3),
cor_prom_invertido = round(cor_prom_invertido, 3)
)
}
analizar_grupo(df_limpio, c(7, 17))      # Autoaceptación
analizar_grupo(df_limpio, c(21, 27, 28)) # Crecimiento personal
analizar_grupo(df_limpio, c(6, 11, 15, 16, 20)) # Propósito de vida
analizar_grupo(df_limpio, c(10, 14, 29)) # Dominio del entorno
analizar_grupo(df_limpio, c(2, 12, 25))  # Relaciones positivas
analizar_grupo(df_limpio, c(3, 18))      # Autonomía
# Invertir ítem identificado
df_limpio$`A menudo me siento solo porque tengo pocos amigos íntimos con quienes compartir mis preocupaciones.` <-
7 - df_limpio$`A menudo me siento solo porque tengo pocos amigos íntimos con quienes compartir mis preocupaciones.`
items <- df_limpio[, 28:ncol(df_limpio)]
resumen_items <- items %>%
summarise(across(everything(),
list(
media = ~ mean(.x, na.rm = TRUE),
mediana = ~ median(.x, na.rm = TRUE),
sd = ~ sd(.x, na.rm = TRUE),
min = ~ min(.x, na.rm = TRUE),
max = ~ max(.x, na.rm = TRUE)
),
.names = "{.col}_{.fn}"))
resumen_largo <- resumen_items %>%
pivot_longer(everything(), names_to = c("item", ".value"), names_sep = "_")
head(resumen_largo)
frecuencias_items <- items %>%
pivot_longer(everything(), names_to = "item", values_to = "valor") %>%
group_by(item, valor) %>%
summarise(frecuencia = n(), .groups = "drop_last") %>%
mutate(porcentaje = round(100 * frecuencia / sum(frecuencia), 2)) %>%
arrange(item, valor)
print(head(frecuencias_items, 12))
for (i in unique(frecuencias_items$item)) {
p <- frecuencias_items %>%
filter(item == i) %>%
ggplot(aes(x = factor(valor), y = porcentaje, fill = factor(valor))) +
geom_bar(stat = "identity", color = "black") +
geom_text(aes(label = paste0(porcentaje, "%")), vjust = -0.3, size = 3) +
scale_fill_brewer(palette = "Blues") +
labs(title = paste("Distribución de frecuencias -", i),
x = "Valor de respuesta (1 a 6)", y = "Porcentaje (%)") +
theme_minimal()
print(p)
}
items_num <- items %>% mutate(across(everything(), as.numeric))
df_limpio <- df_limpio %>%
mutate(metrica_global = rowSums(items_num, na.rm = TRUE))
# Resumen General
resumen_general <- df_limpio %>%
summarise(
total_encuestados = n(),
suma_total = sum(metrica_global, na.rm = TRUE),
promedio_general = mean(metrica_global, na.rm = TRUE),
desviacion_estandar = sd(metrica_global, na.rm = TRUE)
)
# Resumen Modalidad
resumen_modalidad <- df_limpio %>%
group_by(Modalidad) %>%
summarise(
promedio_modalidad = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Nivel de formación
resumen_nivel <- df_limpio %>%
group_by(`Nivel de formación`) %>%
summarise(
promedio_nivel = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Género
resumen_genero <- df_limpio %>%
group_by(Género) %>%
summarise(
promedio_genero = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
# Resumen Estrato Socioeconomico
resumen_estrato <- df_limpio %>%
group_by(`Estrato socioeconómico`) %>%
summarise(
promedio_estrato = mean(metrica_global, na.rm = TRUE),
n = n(),
suma_total = sum(metrica_global, na.rm = TRUE)
)
cat("\nResumen general:\n"); print(resumen_general)
cat("\nResumen por modalidad:\n"); print(resumen_modalidad)
cat("\nResumen por nivel de formación:\n"); print(resumen_nivel)
cat("\nResumen por género:\n"); print(resumen_genero)
cat("\nResumen por estrato socioeconómico:\n"); print(resumen_estrato)
describe(items)
items <- items %>% as.data.frame()
it_cols <- paste0("it", 1:length(items))
colnames(items) <- it_cols
k <- 6
pc <- hetcor(items)$correlations ; pc
fa.parallel(pc, n.obs = nrow(items), fm = "minres")
efa1 <- fa(pc, nfactors = 1, fm = "minres")
alpha_ord <- alpha(pc, n.obs = nrow(df), check.keys = TRUE)
alpha_ord <- psych::alpha(pc, n.obs = nrow(df), check.keys = TRUE)
omega_ord <- omega(pc, n.obs = nrow(df))
alpha_ord <- alpha(pc, n.obs = nrow(df), check.keys = TRUE)
omega_ord <- omega(pc, n.obs = nrow(df))
omega_ord <- omega(pc, n.obs = nrow(df))
omega_ord <- omega(pc, n.obs = nrow(df))
alpha_raw <- alpha(items, check.keys = TRUE)
rit <- alpha_raw$item.stats$r.drop
alpha_if_del <- alpha_raw$alpha.drop$raw_alpha
alpha_raw <- psych::alpha(items, check.keys = TRUE)
rit <- alpha_raw$item.stats$r.drop
alpha_if_del <- alpha_raw$alpha.drop$raw_alpha
item_means <- sapply(items, mean)
p_star <- item_means / k
difficulty <- 1 - p_star
total <- rowMeans(items, na.rm = TRUE) * length(it_cols)
reliab <- alpha_ord$total$raw_alpha # o omega_ord$omega.tot
SEM <- sd(total, na.rm = TRUE) * sqrt(1 - reliab)
# =========================================================
# 1) Selecciona los archivos (saldrá un cuadro de diálogo)
# =========================================================
cat("Selecciona el archivo de Bucaramanga...\n")
path_bga <- file.choose()
path_tun <- file.choose()
path_vil <- file.choose()
# Paquetes necesarios
# install.packages(c("readxl","dplyr"))  # <- descomenta si no los tienes
library(readxl)
library(dplyr)
# =========================================================
# 1) Selecciona los archivos (saldrá un cuadro de diálogo)
# =========================================================
cat("Selecciona el archivo de Bucaramanga...\n")
path_bga <- file.choose()
cat("Selecciona el archivo de Tunja...\n")
path_tun <- file.choose()
cat("Selecciona el archivo de Villavicencio...\n")
path_vil <- file.choose()
# =========================================================
# 2) Bucaramanga: tiene una sola hoja -> tomamos esa
# =========================================================
sheets_bga <- excel_sheets(path_bga)
sheet_bga  <- sheets_bga[1]
bga <- read_excel(path_bga, sheet = sheet_bga)
# =========================================================
# 3) Tunja: usar SOLO la hoja "exportar hoja de trabajo"
#    (ignorando "Secuelas")
# =========================================================
sheets_tun <- excel_sheets(path_tun)
# Buscar por nombre (insensible a mayúsculas/espacios)
target_tun <- grepl("exportar\\s*hoja\\s*de\\s*trabajo",
tolower(sheets_tun))
if (!any(target_tun)) {
message("⚠️ No se encontró 'exportar hoja de trabajo' en Tunja; se usa la primera hoja.")
sheet_tun <- sheets_tun[1]
} else {
sheet_tun <- sheets_tun[which(target_tun)[1]]
}
tun <- read_excel(path_tun, sheet = sheet_tun)
# =========================================================
# 4) Villavicencio: leer 2 hojas -> pregrado y pos/postgrado
# =========================================================
sheets_vil <- excel_sheets(path_vil)
# Buscar nombres típicos (pre / pos|post), insensible a mayúsculas
pre_idx <- which(grepl("^\\s*pre", tolower(sheets_vil)))
pos_idx <- which(grepl("pos|post", tolower(sheets_vil)))
# Pequeños respaldos por si los nombres no coinciden exactamente
if (length(pre_idx) == 0)  pre_idx <- 1
if (length(pos_idx) == 0)  pos_idx <- setdiff(1:min(2, length(sheets_vil)), pre_idx)[1]
sheet_pre <- sheets_vil[pre_idx[1]]
sheet_pos <- sheets_vil[pos_idx[1]]
vil_pre <- read_excel(path_vil, sheet = sheet_pre)
vil_pos <- read_excel(path_vil, sheet = sheet_pos)
bga= rename(bga,
SEDE = `Seccional`,
PROGRAMA  = `Programa`,
PERÍODO =`Período`,
NOMBRE = `Nombre`,
MODALIDAD =`Modalidad`,
NUM_IDENTIFICACION = `Identificación`,
ID_TIPO_DOCUMENTO=`Tipo identificación`,
GÉNERO=`Género`,
COD_UNIDAD=`Cód. Programa`,
DIVISION=`División`,
SEMESTRE=`Semestre`,
DIR_EMAIL =`Correo electrónico institucional`,
DIR_EMAIL_PER=`Correo electrónico personal`)
tun= rename(tun,
PERÍODO =`PRDO_MATRICULA`,
NOMBRE = `NOM_LARGO`,
GÉNERO=`GEN_TERCERO`,
SEMESTRE=`NUM_NIV_CURSA`)
vil_pre= rename(vil_pre,
PROGRAMA  = `Programa`,
NOMBRE = `Nombre`,
PERÍODO =`Período`,
COD_PENSUM =`Cód. Pensum`,
NUM_IDENTIFICACION = `Identificación`,
ID_TIPO_DOCUMENTO=`Tipo identificación`,
GÉNERO=`Género`,
COD_UNIDAD=`Cód. Programa`,
COD_ALUMNO=`Documento`,
MODALIDAD =`Modalidad`,
SEMESTRE=`Nivel cursa`,
DIR_EMAIL =`Correo electrónico institucional`)
vil_pos = rename(vil_pos,
PROGRAMA  = `Programa`,
NOMBRE = `Nombre`,
PERÍODO =`Período`,
NUM_IDENTIFICACION = `Identificación`,
ID_TIPO_DOCUMENTO=`Tipo identificación`,
GÉNERO=`Género`,
COD_UNIDAD=`Cód. Programa`,
COD_ALUMNO=`Código del alumno`,
SEMESTRE=`Nivel cursa`,
DIR_EMAIL =`Correo electrónico institucional`)
# ===========================================================
#
#============================================================
BGA = dplyr::select(bga,"PERÍODO", "ID_TIPO_DOCUMENTO", "NUM_IDENTIFICACION","NOMBRE","GÉNERO","COD_UNIDAD","PROGRAMA","SEMESTRE","DIR_EMAIL")
TUN = dplyr::select(tun,"PERÍODO", "ID_TIPO_DOCUMENTO", "NUM_IDENTIFICACION","NOMBRE","GÉNERO","COD_UNIDAD","PROGRAMA","SEMESTRE","DIR_EMAIL")
VIL_PRE = dplyr::select(vil_pre,"PERÍODO", "ID_TIPO_DOCUMENTO", "NUM_IDENTIFICACION","NOMBRE","GÉNERO","COD_UNIDAD","PROGRAMA","SEMESTRE","DIR_EMAIL")
VIL_POS =dplyr::select(vil_pos,"PERÍODO", "ID_TIPO_DOCUMENTO", "NUM_IDENTIFICACION","NOMBRE","GÉNERO","COD_UNIDAD","PROGRAMA","SEMESTRE","DIR_EMAIL")
datos_union <- bind_rows(BGA, TUN, VIL_PRE, VIL_POS)
dim(datos_union)
# --------- PARÁMETROS (EDITA ESTO) ----------
df        <- datos_union            # o BGA, bga, etc.
strata    <- c("PROGRAMA","SEMESTRE")      # variables de estratificación
target_n  <- 400                    # tamaño muestral total deseado
order_by  <- c("programa","semestre","id")  # orden dentro de cada estrato
set.seed(20251023)
# --------- CÁLCULOS -------------------------
# 1) Construir etiqueta de estrato
df <- df %>% mutate(.estrato = interaction(!!!syms(strata), drop = TRUE))
# 2) Tamaños por estrato y asignación proporcional
Nh <- df %>% count(.estrato, name = "N_h")
N  <- sum(Nh$N_h)
Nh <- Nh %>% mutate(n_h = pmax(0, round(N_h * target_n / N)))
# Ajuste fino para que sum(n_h) == target_n
diff <- target_n - sum(Nh$n_h)
if(diff != 0){
idx <- order(Nh$N_h, decreasing = (diff > 0))[seq_len(abs(diff))]
Nh$n_h[idx] <- Nh$n_h[idx] + sign(diff)
}
# 3) Muestreo sistemático dentro de cada estrato
sampled <- df %>%
right_join(Nh, by = ".estrato") %>%
group_by(.estrato, N_h, n_h) %>%
group_modify(function(sub, key){
n_h <- key$n_h[1]; N_h <- key$N_h[1]
if(n_h <= 0L || N_h == 0L) return(sub[0,])
# Orden operativo (ignora vars que no existan)
keep_ord <- intersect(order_by, names(sub))
if(length(keep_ord) == 0) keep_ord <- ".estrato"
sub <- sub %>% arrange(across(all_of(keep_ord))) %>%
mutate(.pos = row_number())
k <- ceiling(N_h / n_h)
r <- sample.int(k, 1)
idx <- seq(r, N_h, by = k)[1:n_h]
out <- sub %>% filter(.pos %in% idx) %>%
mutate(k = k, r = r, peso = N_h / n_h)
out
}) %>%
ungroup()
df        <- datos_union               # <-- o BGA, etc.
strata    <- c("PROGRAMA","SEMESTRE")         # variables de estratificación
target_n  <- 400                       # tamaño muestral total
order_by  <- c("programa","semestre","id")  # orden dentro de cada estrato
set.seed(20251023)
# =================== CÁLCULOS =====================
# 1) Etiqueta de estrato
df <- df %>% mutate(.estrato = interaction(!!!rlang::syms(strata), drop = TRUE))
# 2) Tamaños por estrato y asignación proporcional
Nh <- df %>% count(.estrato, name = "N_h")
N  <- sum(Nh$N_h)
Nh <- Nh %>% mutate(n_h = pmax(0L, round(N_h * target_n / N)))
# Ajuste fino para que sum(n_h) == target_n
diff <- target_n - sum(Nh$n_h)
if (diff != 0L) {
idx <- order(Nh$N_h, decreasing = (diff > 0L))[seq_len(abs(diff))]
Nh$n_h[idx] <- Nh$n_h[idx] + sign(diff)
}
# 3) Muestreo sistemático por estrato (bloque corregido)
muestra <- df %>%
right_join(Nh, by = ".estrato") %>%
group_by(.estrato, N_h, n_h) %>%
group_modify(function(sub, key){
n_h <- key$n_h[1]; N_h <- key$N_h[1]
if (n_h <= 0L || N_h == 0L) return(sub[0,])
# Orden operativo si existen esas columnas; si no, deja el orden original
keep_ord <- intersect(order_by, names(sub))
if (length(keep_ord) > 0) sub <- sub %>% arrange(across(all_of(keep_ord)))
sub <- sub %>% mutate(.pos = dplyr::row_number())
k <- ceiling(N_h / n_h)
r <- sample.int(k, 1)
idx <- seq(r, N_h, by = k)[1:n_h]
sub %>%
filter(.pos %in% idx) %>%
mutate(k = k, r = r, peso = N_h / n_h)
}) %>%
ungroup() %>%
select(-.pos)
# 4) (Opcional) Resumen rápido
muestra %>% count(.estrato, name = "n_h") %>%
left_join(Nh, by = ".estrato") %>%
select(.estrato, N_h, n_h) %>%
arrange(desc(N_h)) %>% print(n = 100)
# 4) (Opcional) Resumen rápido
# ---- Resumen correcto (sin choque de nombres) ----
resumen <- muestra %>%
dplyr::count(.estrato, name = "n_muestrado") %>%            # tamaño obtenido
dplyr::left_join(
Nh %>% dplyr::select(.estrato, N_h, n_h_asignado = n_h),   # tamaños objetivo
by = ".estrato"
) %>%
dplyr::arrange(dplyr::desc(N_h))
print(resumen, n = 100)
# (opcional) verificar coincidencia por estrato
resumen %>%
dplyr::mutate(diff = n_muestrado - n_h_asignado) %>%
dplyr::filter(diff != 0)
bga <- read_excel(path_bga, sheet = sheet_bga)
